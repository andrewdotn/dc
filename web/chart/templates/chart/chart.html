<!DOCTYPE html>
<html lang=en>
  <head>
    <title>{{ chart.title }}</title>
    <meta charset='UTF-8'>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
    <script type="text/javascript">
    //
    // supportsVml and supportsSVG thanks to http://stackoverflow.com/questions/654112/how-do-you-detect-support-for-vml-or-svg-in-a-browser
    //
    
    function supportsVml() {
        if (typeof supportsVml.supported == "undefined") {
            var a = document.body.appendChild(document.createElement('div'));
            a.innerHTML = '<v:shape id="vml_flag1" adj="1" />';
            var b = a.firstChild;
            b.style.behavior = "url(#default#VML)";
            supportsVml.supported = b ? typeof b.adj == "object": true;
            a.parentNode.removeChild(a);
        }
        return supportsVml.supported
    }
    
    function supportsSVG() {
      return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure", "1.1")
    }

      $(document).ready(function() {

/*
        $("#datafrom").hide();
        $("#postedby").hide();
*/

        $("#datafromhead").click(function() {
          $("#datafrom").slideToggle(400);

          return false;
        });

        $("#postedbyhead").click(function() {
          $("#postedby").slideToggle(400);
          return false;
        });

      });
    </script>

<!-- HIGHCHARTS HOORAY -->

		<script type="text/javascript" src="/static/highcharts.js"></script>
		<script type="text/javascript" src="/static/modules/exporting.js"></script>

		<!-- 2. Add the JavaScript to initialize the chart on document ready -->
		<script type="text/javascript">
		
			var chart;
			$(document).ready(function() {
				chart = new Highcharts.Chart({
					chart: {
						renderTo: 'chartdiv', 
						defaultSeriesType: 'line'
					},
                                        {{ chart.chart_settings|safe }}
					series: [ {{ chart.chart_data|safe }} ],
					exporting: {url: "/chart/convert/{{ chart.id|safe }}/"}
				});
				
				
			});
				
		</script>

<!-- HIGHCHARTS GOODBYE -->

    <style>
      body {
        font: 100% verdana;
        margin:0;
        padding:0;
      }
      .title {
        background-color:#ffde00;
        padding-left: 0.5em;
        padding-right: 0.5em;
        padding-top: 0.25em;
        padding-bottom: 0.25em;
        font-size:1.5em;
        border-radius:15px;
      }
      .titlediv {
        margin-top: 1.5em;
        margin-bottom: 1.5em;
      }
      .bottom_nav {
        padding-left: 1em;
        padding-right: 1em;
      }
      #chart_wrapper {
        padding: 0px;
        margin: 0px;
/*
        width: 600px;
        height: 350px;
*/
        overflow: hidden;
      }
      #disqus_wrapper {
        padding:0.5em;
        margin-top: 1.5em;
        margin-bottom: 1.5em;
        max-width:800px;
        background-color:#eeffee;
        border-radius:15px;
        border:2px solid #ccddcc;
        /*  outline:#ddeedd solid medium; */
      }
    </style>
  </head>
  <body style="background-color:#fffafc">


    <div id="container" style="width:100%; background-color:#fffafc">
      <div id="main" style="width:800px; margin:auto">
        <div class="titlediv">
          <div class="title" style="background-color:#990031; color:#ffffff; font-size:2em; max-width:750px;">The Data Collective
          {% ifequal user.username "admin" %} ADMIN MODE {% endifequal %} </div>
        </div>
        <div class="titlediv" style="margin-bottom:0px">
          <div class="title" style="max-width:550px">{{ chart.title }}</div>
        </div>

        <div id=chart_and_addthis_wrapper style="width:600px; margin-bottom:50px">
          <div id=chart_wrapper style="border-radius:15px; border:6px solid #ffde00; padding: 8px">
            <script>
              if (supportsSVG() || supportsVml()) {
                document.write('<div id="chartdiv" style="height:400px; padding:5px; background-color:#fffafc"></div>');      
              } else {
                document.write('<img src="/static/images/medicaid.png" alt="{{ chart.title }}"/>')
              }
            </script>
            <noscript>
              <img src="/static/images/medicaid.png" alt="{{ chart.title }}"/>
            </noscript>

	    
          </div>

	  <span style="float:left; width:280px">
	    <div>
	      <a target="_blank" href=" {{ chart.csv_url }} ">
		<img src="/static/images/csv_32x32.png" style="position:relative; left:20px">
	      </a>
<!--
XLS doesnt really work yet.  Need to think about it some more.

	      <a target="_blank" href=" {{ chart.xls_url }} ">
		<img src="/static/images/xls_32x32.png" style="position:relative; left:20px">
	      </a>
-->
	    </div>
	  </span>
				   
	  <span style="float:right; width:280px">
	    <!-- AddThis Button BEGIN -->
	    <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
	      <a class="addthis_button_preferred_1"></a>
	      <a class="addthis_button_preferred_2"></a>
	      <a class="addthis_button_preferred_3"></a>
	      <a class="addthis_button_preferred_4"></a>
	      <a class="addthis_button_compact"></a>
	      <a class="addthis_counter addthis_bubble_style"></a>
	    </div>
	    <script type="text/javascript">
	      var addthis_config = {"data_track_clickback":false};
	      var addthis_share = {
                title: "{{ chart.title }}",
                url: "{{ url }}",
                lurl: "{{ shorturl }}",
                templates: {
                  twitter: "{{ chart.tweet }}"
                }
	      }
	    </script>
	    <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=ra-4db065a4597e8114"></script>
	    <!-- AddThis Button END -->
	  </span>
        </div>



        <div class="titlediv">
          <div id="datafromhead" class="title" style="background-color:#E58F17; max-width:600px">
            <span> {{ chart.source_title }} </span>
            <span style="padding-left:2em"></span>
            <span style="font-size:0.5em">▼</span>
          </div>
          <div id="datafrom" class="title" style="background-color:#E58F17; max-width:800px; margin-top:-1.0em; border-top-left-radius:0px">
            <br>
            {% autoescape off %}
            {{ chart.source_detail }}
            {% endautoescape %}
          </div>
        </div>

        <div class="titlediv">
          <span id="postedbyhead" class="title" style="background-color:#BF5F22">
            <span>posted by {{ chart.chart_creator }}</span>
            <span style="padding-left:2em"></span>
            <span style="font-size:0.5em">▼</span>
          </span>
          <div id="postedby" class="title" style="background-color:#BF5F22; max-width:800px; margin-top:-0.5em; border-top-left-radius:0px">
            <div  style="float:right; margin-right:0px; margin-top:10px">
              <img src="{{ chart.chart_creator_avatar }}" style="border-radius:5px; border:5px solid #fffafc; padding:0px">
            </div>
            <br>
            {% autoescape off %}
            {{ chart.chart_creator_detail }}
            {% endautoescape %}

          </div>
        </div>

        <div id="disqus_wrapper">
          <div id="disqus_thread"></div>
          <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'd4t4'; // required: replace example with your forum shortname

            // The following are highly recommended additional parameters. Remove the slashes in front to use.
            var disqus_identifier = '{{ chart.disqus_identifier }}';
            var disqus_url = 'http://d4t4.org/chart/{{ chart.short_name }}';

            {% if debug %}
            var disqus_developer = 1;
            {% endif %}

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

        </div>
        <div class="titlediv">
          <div class="title" style="background-color:#990031; color:#ffffff; width:800px; font-size:1.0em; padding-top:1em; padding-bottom:1em">
            <span class="bottom_nav">About</span>
            <span class="bottom_nav">Blog</span>
            <span class="bottom_nav">Contact</span>
            <span class="bottom_nav">Help</span>
            <span class="bottom_nav">Terms</span>
            <span style="float:right">©2011 The Data Collective</span>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
